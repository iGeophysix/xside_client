from shapely.geometry import Point

import randomizer
from db import DB
from settings import XSIDE_HOST, XSIDE_USER, XSIDE_PASSWORD
from xside_client import XSide, LogEvent

coordinates = [[37.46312141418457, 55.72590170949503], [37.461222410202026, 55.72555731561523], [37.46112585067749, 55.725792953861145], [37.46195197105408, 55.726209848812736],
               [37.463496923446655, 55.72648777630759], [37.466275691986084, 55.72694695653009], [37.469236850738525, 55.727502799048146], [37.47287392616272, 55.72819154945165],
               [37.47662901878357, 55.728886329215214], [37.48082399368286, 55.729647551979234], [37.48465418815613, 55.7303725122415], [37.48904228210449, 55.73121224105063],
               [37.49332308769226, 55.731961336399294], [37.49852657318115, 55.73295809421135], [37.50466346740723, 55.73409376300201], [37.51148700714111, 55.73525356085639],
               [37.51659393310547, 55.736002578656034], [37.5238037109375, 55.73750057113552], [37.529296875, 55.73878106751433], [37.53633499145508, 55.74035143024509],
               [37.54358768463135, 55.74312960951608], [37.549638748168945, 55.74544863378904], [37.554917335510254, 55.74711534735536], [37.56247043609619, 55.74921675428498],
               [37.57058143615722, 55.75153541678325], [37.57452964782714, 55.75254978829088], [37.58139610290527, 55.75254978829088], [37.59238243103027, 55.752622242389236],
               [37.59899139404297, 55.752887906265094], [37.60113716125488, 55.752887906265094], [37.60122299194336, 55.75225997055175], [37.6012659072876, 55.75148711272018],
               [37.60422706604004, 55.75032779726215], [37.60886192321777, 55.749240907729636], [37.60993480682373, 55.750907459297785], [37.61126518249512, 55.753032813071115],
               [37.612810134887695, 55.75510975147018], [37.615127563476555, 55.757114133658895], [37.6131534576416, 55.758200803830924], [37.609806060791016, 55.76143648680249],
               [37.60688781738281, 55.76382685625667], [37.60590076446533, 55.76462361351137], [37.60499954223633, 55.765106488772155], [37.60289669036865, 55.766217079176876],
               [37.60062217712402, 55.76749663324687], [37.59916305541992, 55.768245032200014], [37.596888542175286, 55.76959694227789], [37.59572982788085, 55.770321160534415],
               [37.593927383422844, 55.77135918323877], [37.591867446899414, 55.772710985321105], [37.589592933654785, 55.77396618813479], [37.587833404541016, 55.77495583877638],
               [37.58543014526367, 55.77645233591819], [37.58375644683838, 55.777369515441904], [37.5810956954956, 55.77862456823268], [37.577362060546875, 55.7805553397555],
               [37.5683069229126, 55.784802700372666], [37.5662899017334, 55.7857920758437], [37.5666332244873, 55.787070987391914], [37.5692081451416, 55.78822921067784],
               [37.562642097473145, 55.78342718541095], [37.5582218170166, 55.78026573012571], [37.55581855773926, 55.7772246990574], [37.55393028259277, 55.77519721316974],
               [37.55156993865967, 55.77420756865713], [37.547879219055176, 55.77382135910387], [37.54500389099121, 55.77285581847794], [37.53903865814209, 55.76838988195085],
               [37.53539085388183, 55.762136711212015], [37.53200054168701, 55.75397469418902], [37.53109931945801, 55.75155956879236], [37.53324508666992, 55.74448239042482],
               [37.535948753356934, 55.73904682564913], [37.541399002075195, 55.7351569123514], [37.54470348358154, 55.72986504147143], [37.544403076171875, 55.728511753835235],
               [37.53856658935547, 55.72785925910717], [37.535133361816406, 55.726626739313176], [37.534446716308594, 55.72505582435831], [37.53440380096435, 55.722034656422565],
               [37.534918785095215, 55.71765959097546], [37.53556251525878, 55.71550813595293], [37.53654956817626, 55.71304227772144], [37.53848075866699, 55.71101145406474],
               [37.54058361053467, 55.70939155474986], [37.540411949157715, 55.70898052483784], [37.538137435913086, 55.707795767368054], [37.535433769226074, 55.70641753490576],
               [37.53200054168701, 55.70450727269221]
               ]
xside = XSide(host=XSIDE_HOST, email=XSIDE_USER, password=XSIDE_PASSWORD)

db = DB()
df = db.get_items()
if __name__ == '__main__':
    for coordinate in coordinates:
        point = Point(*coordinate)
        image = randomizer.get_image_in_point(df, point)
        xside.send_log(event=LogEvent.SHOW, item_file=image, lat=coordinate[1], lon=coordinate[0])
